<!doctype html>
<html lang=ru>

<!-- If you make edits to any FAQ documents, please start each sentence
     on a new line, and try to keep the general formatting consistent
     with the rest of the pages -->

<title>OpenBSD FAQ: Общие вопросы</title>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/faq/faq8.html">

<h2 id=OpenBSD>
<a href="../index.html">
<i>Open</i><b>BSD</b></a>
FAQ - Общие вопросы
<small>
<a href="index.html">[FAQ Index]</a>
</small>
</h2>
<hr>

<ul>
  <li><a href="#LostPW"    >Я забыл свой пароль root</a>
  <li><a href="#OpenNTPD"  >Использование OpenNTPD</a>
  <li><a href="#TimeZone"  >Часовые пояса</a>
  <li><a href="#locales"   >Набор символов (character sets) и локализация</a>
  <li><a href="#RevDNS"    >Обратный просмотр DNS</a>
  <li><a href="#GenNotConf">Устройство "not configured" в dmesg</a>
</ul>

<hr>

<h2 id="LostPW">Я забыл свой пароль root</h2>

Процесс восстановления пароля включает следующие шаги - загрузку в
однопользовательском режиме, монтирование разделов <code>/</code> и
<code>/usr</code>, выполнение команды
<a href="https://man.openbsd.org/passwd">passwd(1)</a> для смены
пароля root:

<ul>
  <li><b>Загрузка в однопользовательском режиме.</b>
    Эта часть процесса различается для разных
    <a href="https://www.openbsd.org/plat.html">платформ</a>.
    Для amd64 и i386, на
    <a href="https://www.openbsd.org/faq/faq14.html#BootAmd64">на втором этапе загрузки</a>
    есть пауза для введения параметров ядра.
    В примере ниже видно как мы передали <code>-s</code> флаг для
    <a href="https://man.openbsd.org/OpenBSD-current/i386/boot">boot(8)</a>:

<pre class="cmdbox">
probing: pc0 com0 com1 mem[638K 1918M a20=on]
disk: hd0+ hd1+
>> OpenBSD/amd64 BOOT 3.33
boot> <b>boot -s</b>
</pre>

  <li><b>Монтирование разделов.</b>
    Оба раздела <code>/</code> и <code>/usr</code> должны быть подмонтированны
    в режиме чтения и записи.

<pre class="cmdbox">
# <b>fsck -p / &amp;&amp; mount -uw /</b>
# <b>fsck -p /usr &amp;&amp; mount /usr</b>
</pre>

  <li><b>Запустите <a href="https://man.openbsd.org/passwd">passwd(1)</a>
    для смены пароля root.</b>
    Поскольку вы загрузились в однопользовательском режиме, у вас уже есть
    права root, поэтому пароль вводить не портебуется.

  <li><b>Загрузка в многопользовательском режиме.</b>
    Это можно сделав нажав "CTRL-D" для перехода в нормальный режим загрузки,
    или выполнив команду
    <a href="https://man.openbsd.org/reboot">reboot(8)</a>.
</ul>

<h2 id="OpenNTPD">Использование OpenNTPD</h2>

<a href="https://openbsd-ru.github.io/openntpd/index.html">OpenNTPD</a>
это надежный и простой NTP-совместимый способ иметь точное время в системе.
<a href="https://man.openbsd.org/ntpd">ntpd(8)</a> демон включается по умолчанию
во время установки, в результате чего часы вашего компьютера медленно
синхронизируются с серверами <a href="http://www.pool.ntp.org">pool.ntp.org</a>.
Как только часы будут точно настроенны, <code>ntpd</code> будет следить
за тем, чтобы они не убежали. Однако, если ваши часы все равно отстают хотя бы
на несколько минут, рекомедуется настроить их при помощи <code>-s</code>
параметра.

<p>
Для использования OpenNTPD в качестве сервера, добавьте строку
<code>listen on *</code> в ваш
<a href="https://man.openbsd.org/ntpd.conf">ntpd.conf(5)</a> файл и
перезапустите демон.
Можно настроить его и так, чтобы он работал только со специально указанным
адресом или интерфейсом.

<p>
После того как вы запустете <a href="https://man.openbsd.org/ntpd">ntpd(8)</a>
в качестве сервера, другие машины, возможно, не смогут синхронизировать
настройки времени сразу же. Это связано с тем, что информация о времени не
будет предоставляться сервером до тех пор, пока не будет достигнут достаточный
уровень стабильности. Как только этот уровень будет досигнут, в
<code>/var/log/daemon</code> появится сообщение "clock now synced".

<h2 id="TimeZone">Часовые пояса</h2>

OpenBSD предполагает, что ваши аппаратные часы настроены в соответствии с UTC
(Universal Coordinated Time), а не по местному времени. Это может причиной проблем при
<a href="https://www.openbsd.org/faq/faq4.html#Multibooting">мультизагрузке</a>.
Большинство других операционных ситем могут быть настроены по тому же принципу,
что и OpenBSD, чтобы избежать эту проблему.

<p>
Если испрользование UTC является причиной проблем, вы всегда можете изменить
настройки, используя
<a href="https://man.openbsd.org/config">config(8)</a>.
Например, чтобы сконфигурировать OpenBSD для использования аппаратные часов
установленных на US/Eastern (5 часов или 300 минут от UTC):

<pre class="cmdbox">
# <b>config -ef /bsd</b>
[...]
Enter 'help' for information
ukc> <b>timezone 300</b>
timezone = 300, dst = 0
ukc> <b>quit</b>
Saving modified kernel.
</pre>

Ознакомьтесь с <a href="https://man.openbsd.org/options">options(4)</a>
и обратите внимание на опцию "TIMEZONE=value".

<p>
Обычно, часовой пояс настраивается во время установки.
Если вам нужно изменить часовой пояс, вы можете создать новый symbolic link
на подходящий файл часового пояса в <code>/usr/share/zoneinfo</code>.
Например, чтобы настроить машину для использования EST5EDT в качестве
нового локального часового пояса:

<pre class="cmdbox">
# <b>ln -fs /usr/share/zoneinfo/EST5EDT /etc/localtime</b>
</pre>

Смотрите также руководство по <a href="https://man.openbsd.org/date">date(1)</a>.

<h2 id="locales">Набор символов (character sets) и локализация</h2>

The OpenBSD base system fully supports the ASCII character set and encoding, and
partially supports the UTF-8 encoding of the Unicode character set.
No other encodings or character sets are supported by the base system, but ports
can be used to handle them.
The level of UTF-8 support and the default encoding configuration vary greatly
with the program or library.

<p>
To use the Unicode character set in UTF-8 encoding whereever supported, set the
<code>LC_CTYPE</code> environment variable to the value
<code>en_US.UTF-8</code>:

<ul>
  <li>
    If logging in via <a href="https://man.openbsd.org/xenodm">xenodm(1)</a>,
    add <code>export LC_CTYPE="en_US.UTF-8"</code> to your
    <code>~/.xsession</code>
    before starting the window manager.
    See <a href="faq11.html#CustomizingX">customizing X</a> for more details.
  <li>
    If logging in via the text console, add
    <code>export LC_CTYPE="en_US.UTF-8"</code> to your <code>~/.profile</code>.
    The text console's UTF-8 support is a work in progress, and some non-ASCII
    characters may not display properly.
</ul>

When logging into remote systems with
<a href="https://man.openbsd.org/ssh">ssh(1)</a>, the <code>LC_CTYPE</code>
environment variable is not propagated, and you have to make sure that the local
terminal is set to the character encoding used by the remote server before
connecting.
If that encoding is unknown or unsupported by OpenBSD, make sure you use the
default <a href="https://man.openbsd.org/xterm">xterm(1)</a> configuration and
set <code>LC_CTYPE=en_US.UTF-8</code> in the remote shell after connecting.

<p>
The OpenBSD base system completely ignores all locale-related environment
variables except <code>LC_CTYPE</code>; even <code>LC_ALL</code> and
<code>LANG</code> only affect the character encoding.
Some ports may respect other <code>LC_*</code> variables,
but using them or setting <code>LC_CTYPE</code> to any value other than
<code>C</code>, <code>POSIX</code> or <code>en_US.UTF-8</code>
is not recommended.

<h2 id="RevDNS">Обратный просмотр DNS</h2>

Some new users experience a login delay when using services such as
<a href="https://man.openbsd.org/ssh">ssh(1)</a>, or when using a proxy or
sending mail.

<p>
This is almost always due to a reverse DNS problem.
DNS is the Domain Name Service, the system the internet uses to convert a name
(such as "www.openbsd.org") into a numeric IP address.
Another task of DNS is the ability to take a numeric address and convert it
back to a name.
This is known as a reverse DNS entry.

<p>
In order to provide better logging, OpenBSD performs a reverse DNS
lookup on any machine that attaches to it in many different ways,
including <a href="https://man.openbsd.org/ssh">ssh(1)</a>,
<a href="https://man.openbsd.org/ftp">ftp(1)</a> and
<a href="https://man.openbsd.org/ftp-proxy">ftp-proxy(8)</a>.
Unfortunately, in some cases, the machine that is making the connection
does not have a proper reverse DNS entry.

<h3>Fix Using the hosts File</h3>

The simplest fix is as follows:
Populate your <a href="https://man.openbsd.org/hosts">hosts(5)</a>
file with all the workstations you have in your internal network.
Make sure that your
<a href="https://man.openbsd.org/resolv.conf">resolv.conf(5)</a>
file contains the line <code>lookup file bind</code>.
This tells the resolver to start with the
<a href="https://man.openbsd.org/hosts">hosts(5)</a> file,
and, failing that, to use the DNS servers specified by the
<code>nameserver</code>
lines in your <a href="https://man.openbsd.org/resolv.conf">resolv.conf(5)</a>.

<p>
Your <code>/etc/hosts</code> file might look something like this:

<pre class="cmdbox">
::1          localhost.in.example.org localhost
127.0.0.1    localhost.in.example.org localhost
192.168.1.1  gw.in.example.org        gw
192.168.1.20 scrappy.in.example.org   scrappy
192.168.1.35 shadow.in.example.org    shadow
</pre>

Your <code>/etc/resolv.conf</code> file might look something like this:

<pre class="cmdbox">
search in.example.org
nameserver 24.2.68.33
nameserver 24.2.68.34
lookup file bind
</pre>

If you are using <a href="faq6.html#DHCP">DHCP</a>, you should add
<code>lookup file bind</code> to your <code>/etc/resolv.conf.tail</code> file,
as <code>resolv.conf</code> will be overwritten by
<a href="https://man.openbsd.org/dhclient">dhclient(8)</a>.

<h2 id="GenNotConf">Устройство "not configured" в dmesg</h2>

Если в двух словах, то это значит, что устройство не поддерживается
используемым ядром, т.е. вы не можете пользоваться этим устройством.

<p>
PCI и многие другие типы устройств предоставляют о себе так называемую
информацию идетификации, чтобы ОС могла правильно распознать и
работать с ними. В добавлении этого механизма распознавания нет ничего
сложного, а вот добавление поддержки самого устройства - нет.
Вот пример двух «не настроенных» устройств:

<pre class="cmdbox">
[...]
vendor "Intel", unknown product 0x5201 (class network subclass ethernet,
rev 0x03) at pci2 dev 9 function 1 not configured
[...]
"Intel EE Pro 100" rev 0x03 at pci2 dev 10 function 0 not configured
[...]
</pre>

Тут у нас две сетевые карты, ни одна из них не работает. У первой был
идентифицирован код поставщика, и был определен общий тип карты, но не
её точная модель. Вторая была полностью идентифицированна, но сообщение
<code>not configured</code> говорит нам, что для него не найден драйвер.

<h4>Что я могу сделать с "not configured" устройствами?</h4>

<ul>
  <li>Если поддержка этих устройств вам не нужна, но можно просто игнорировать
      эти <code>not configured</code> предупреждения.
  <li>Иногда это просто один из вариантов поддерживаемого устройства. Другими
      словами, разработчику может быть относительно просто добавить поддержку
      новой карты. В противном случае необходимо будет написать новый драйвер,
      что может быть даже невозможно, если устройство не полностью документировано.
  <li>Если используется установленное ядро, устройство может не поддерживаться
      из-за нехватки места (due to space constraints).
      Удостоверьтесь, что проблема проявляется при использовании стандартного
      <code>GENERIC</code> ядра.
  <li>Прежде чем сообщать о <code>not configured</code> устройстве, удостоверьтесь,
      что вы протестировали наиболее свежие <a href="faq5.html#Flavors">снапшоты</a>,
      т.к. поддержка, возможно, уже была добавленна там.
      Так же не поленитесь проверить <a href="https://www.openbsd.org/mail.html">
      архив рассылки</a>, чтобы не создавать повторное обсуждение.
</ul>
